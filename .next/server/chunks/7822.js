"use strict";exports.id=7822,exports.ids=[7822],exports.modules={47822:(e,t,r)=>{r.d(t,{P:()=>g});let i=/\\(\\)?/g,o=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g"),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/,l=function(e){let t=typeof e;return"symbol"===t||"object"===t&&e&&"[object Symbol]"===Object.prototype.toString.call(e)},u=function(e,t){if(Array.isArray(e))return!1;let r=typeof e;return!!("number"===r||"symbol"===r||"boolean"===r||!e||l(e))||s.test(e)||!n.test(e)||null!=t&&e in Object(t)},a=function(e){let t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,r,o,n){let s=e;o?s=n.replace(i,"$1"):r&&(s=r.trim()),t.push(s)}),t},f=function(e){if("string"==typeof e||l(e))return e;let t=`${e}`;return"0"==t&&1/e==-INFINITY?"-0":t},c=function(e,t){var r,i;r=t,i=e;let o=0,n=(t=Array.isArray(r)?r:u(r,i)?[r]:a(r)).length;for(;null!=e&&o<n;)e=e[f(t[o++])];return o&&o===n?e:void 0},d=function(e){if(null==e)return[void 0,void 0];if("object"!=typeof e)return[Error('Invalid option "columns": expect an array or an object')];if(Array.isArray(e)){let t=[];for(let r of e)if("string"==typeof r)t.push({key:r,header:r});else{if("object"!=typeof r||null===r||Array.isArray(r))return[Error("Invalid column definition: expect a string or an object")];if(!r.key)return[Error('Invalid column definition: property "key" is required')];void 0===r.header&&(r.header=r.key),t.push(r)}e=t}else{let t=[];for(let r in e)t.push({key:r,header:e[r]});e=t}return[void 0,e]};class p extends Error{constructor(e,t,...r){for(let i of(Array.isArray(t)&&(t=t.join(" ")),super(t),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,p),this.code=e,r))for(let e in i){let t=i[e];this[e]=Buffer.isBuffer(t)?t.toString():null==t?t:JSON.parse(JSON.stringify(t))}}}let h=function(e){let t={};for(let r in e)t[r.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})]=e[r];if(void 0===t.bom||null===t.bom||!1===t.bom)t.bom=!1;else if(!0!==t.bom)return[new p("CSV_OPTION_BOOLEAN_INVALID_TYPE",["option `bom` is optional and must be a boolean value,",`got ${JSON.stringify(t.bom)}`])];if(void 0===t.delimiter||null===t.delimiter)t.delimiter=",";else if(Buffer.isBuffer(t.delimiter))t.delimiter=t.delimiter.toString();else if("string"!=typeof t.delimiter)return[new p("CSV_OPTION_DELIMITER_INVALID_TYPE",["option `delimiter` must be a buffer or a string,",`got ${JSON.stringify(t.delimiter)}`])];if(void 0===t.quote||null===t.quote)t.quote='"';else if(!0===t.quote)t.quote='"';else if(!1===t.quote)t.quote="";else if(Buffer.isBuffer(t.quote))t.quote=t.quote.toString();else if("string"!=typeof t.quote)return[new p("CSV_OPTION_QUOTE_INVALID_TYPE",["option `quote` must be a boolean, a buffer or a string,",`got ${JSON.stringify(t.quote)}`])];if((void 0===t.quoted||null===t.quoted)&&(t.quoted=!1),void 0===t.escape_formulas||null===t.escape_formulas)t.escape_formulas=!1;else if("boolean"!=typeof t.escape_formulas)return[new p("CSV_OPTION_ESCAPE_FORMULAS_INVALID_TYPE",["option `escape_formulas` must be a boolean,",`got ${JSON.stringify(t.escape_formulas)}`])];if((void 0===t.quoted_empty||null===t.quoted_empty)&&(t.quoted_empty=void 0),void 0===t.quoted_match||null===t.quoted_match||!1===t.quoted_match?t.quoted_match=null:Array.isArray(t.quoted_match)||(t.quoted_match=[t.quoted_match]),t.quoted_match)for(let e of t.quoted_match){let t="string"==typeof e,r=e instanceof RegExp;if(!t&&!r)return[Error(`Invalid Option: quoted_match must be a string or a regex, got ${JSON.stringify(e)}`)]}if((void 0===t.quoted_string||null===t.quoted_string)&&(t.quoted_string=!1),(void 0===t.eof||null===t.eof)&&(t.eof=!0),void 0===t.escape||null===t.escape)t.escape='"';else if(Buffer.isBuffer(t.escape))t.escape=t.escape.toString();else if("string"!=typeof t.escape)return[Error(`Invalid Option: escape must be a buffer or a string, got ${JSON.stringify(t.escape)}`)];if(t.escape.length>1)return[Error(`Invalid Option: escape must be one character, got ${t.escape.length} characters`)];(void 0===t.header||null===t.header)&&(t.header=!1);let[r,i]=d(t.columns);if(void 0!==r)return[r];if(t.columns=i,(void 0===t.quoted||null===t.quoted)&&(t.quoted=!1),(void 0===t.cast||null===t.cast)&&(t.cast={}),(void 0===t.cast.bigint||null===t.cast.bigint)&&(t.cast.bigint=e=>""+e),(void 0===t.cast.boolean||null===t.cast.boolean)&&(t.cast.boolean=e=>e?"1":""),(void 0===t.cast.date||null===t.cast.date)&&(t.cast.date=e=>""+e.getTime()),(void 0===t.cast.number||null===t.cast.number)&&(t.cast.number=e=>""+e),(void 0===t.cast.object||null===t.cast.object)&&(t.cast.object=e=>JSON.stringify(e)),(void 0===t.cast.string||null===t.cast.string)&&(t.cast.string=function(e){return e}),void 0!==t.on_record&&"function"!=typeof t.on_record)return[Error('Invalid Option: "on_record" must be a function.')];if(void 0===t.record_delimiter||null===t.record_delimiter)t.record_delimiter="\n";else if(Buffer.isBuffer(t.record_delimiter))t.record_delimiter=t.record_delimiter.toString();else if("string"!=typeof t.record_delimiter)return[Error(`Invalid Option: record_delimiter must be a buffer or a string, got ${JSON.stringify(t.record_delimiter)}`)];switch(t.record_delimiter){case"unix":t.record_delimiter="\n";break;case"mac":t.record_delimiter="\r";break;case"windows":t.record_delimiter="\r\n";break;case"ascii":t.record_delimiter="\x1e";break;case"unicode":t.record_delimiter="\u2028"}return[void 0,t]},m=Buffer.from([239,187,191]),g=function(e,t={}){let r=[],[i,o]=h(t);if(void 0!==i)throw i;let n={options:o,state:{stop:!1},info:{records:0},__transform:function(e,t){let r,i;if(!Array.isArray(e)&&"object"!=typeof e)return Error(`Invalid Record: expect an array or an object, got ${JSON.stringify(e)}`);if(0===this.info.records){if(Array.isArray(e)){if(!0===this.options.header&&void 0===this.options.columns)return Error("Undiscoverable Columns: header option requires column option or object records")}else if(void 0===this.options.columns){let[t,r]=d(Object.keys(e));if(t)return;this.options.columns=r}}if(0===this.info.records){this.bom(t);let e=this.headers(t);if(e)return e}try{this.options.on_record&&this.options.on_record(e,this.info.records)}catch(e){return e}if(this.options.eof){if([r,i]=this.stringify(e),r)return r;if(void 0===i)return;i+=this.options.record_delimiter}else{if([r,i]=this.stringify(e),r)return r;if(void 0===i)return;(this.options.header||this.info.records)&&(i=this.options.record_delimiter+i)}this.info.records++,t(i)},stringify:function(e,t=!1){if("object"!=typeof e)return[void 0,e];let{columns:r}=this.options,i=[];if(Array.isArray(e)){r&&e.splice(r.length);for(let r=0;r<e.length;r++){let o=e[r],[n,s]=this.__cast(o,{index:r,column:r,records:this.info.records,header:t});if(n)return[n];i[r]=[s,o]}}else for(let o=0;o<r.length;o++){let n=c(e,r[o].key),[s,l]=this.__cast(n,{index:o,column:r[o].key,records:this.info.records,header:t});if(s)return[s];i[o]=[l,n]}let o="";for(let e=0;e<i.length;e++){let t,r;let[s,l]=i[e];if("string"==typeof s)t=this.options;else{var n;if("object"!=typeof(n=s)||null===n||Array.isArray(n)){if(null!=s)return[Error(`Invalid Casting Value: returned value must return a string, an object, null or undefined, got ${JSON.stringify(s)}`)];t=this.options}else{if(s=(t=s).value,delete t.value,"string"!=typeof s&&null!=s&&r)return[Error(`Invalid Casting Value: returned value must return a string, null or undefined, got ${JSON.stringify(s)}`)];if(t={...this.options,...t},[r,t]=h(t),void 0!==r)return[r]}}let{delimiter:u,escape:a,quote:f,quoted:c,quoted_empty:d,quoted_string:p,quoted_match:m,record_delimiter:g,escape_formulas:y}=t;if(""===s&&""===l){let e=m&&m.filter(e=>"string"==typeof e?-1!==s.indexOf(e):e.test(s));!0===((e=e&&e.length>0)||!0===d||!0===p&&!1!==d)&&(s=f+s+f),o+=s}else if(s){if("string"!=typeof s)return[Error(`Formatter must return a string, null or undefined, got ${JSON.stringify(s)}`)];let e=u.length&&s.indexOf(u)>=0,t=""!==f&&s.indexOf(f)>=0,r=s.indexOf(a)>=0&&a!==f,i=s.indexOf(g)>=0,n=p&&"string"==typeof l,d=m&&m.filter(e=>"string"==typeof e?-1!==s.indexOf(e):e.test(s));if(d=d&&d.length>0,y)switch(s[0]){case"=":case"+":case"-":case"@":case"	":case"\r":case"＝":case"＋":case"－":case"＠":s=`'${s}`}let h=!0===t||e||i||c||n||d;if(!0===h&&!0===r){let e="\\"===a?RegExp(a+a,"g"):RegExp(a,"g");s=s.replace(e,a+a)}if(!0===t){let e=RegExp(f,"g");s=s.replace(e,a+f)}!0===h&&(s=f+s+f),o+=s}else(!0===d||""===l&&!0===p&&!1!==d)&&(o+=f+f);e!==i.length-1&&(o+=u)}return[void 0,o]},bom:function(e){!0===this.options.bom&&e(m)},headers:function(e){let t;if(!1===this.options.header||void 0===this.options.columns)return;let r=this.options.columns.map(e=>e.header);if(this.options.eof?([t,r]=this.stringify(r,!0),r+=this.options.record_delimiter):[t,r]=this.stringify(r),t)return t;e(r)},__cast:function(e,t){let r=typeof e;try{if("string"===r)return[void 0,this.options.cast.string(e,t)];if("bigint"===r)return[void 0,this.options.cast.bigint(e,t)];if("number"===r)return[void 0,this.options.cast.number(e,t)];if("boolean"===r)return[void 0,this.options.cast.boolean(e,t)];else if(e instanceof Date)return[void 0,this.options.cast.date(e,t)];else if("object"===r&&null!==e)return[void 0,this.options.cast.object(e,t)];else return[void 0,e,e]}catch(e){return[e]}}};for(let t of e){let e=n.__transform(t,function(e){r.push(e)});if(void 0!==e)throw e}if(0===r.length){n.bom(e=>{r.push(e)});let e=n.headers(e=>{r.push(e)});if(void 0!==e)throw e}return r.join("")}}};