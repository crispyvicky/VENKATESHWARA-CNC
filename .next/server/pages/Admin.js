"use strict";(()=>{var e={};e.id=4343,e.ids=[4343,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},53425:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>h,getServerSideProps:()=>b,getStaticPaths:()=>p,getStaticProps:()=>m,reportWebVitals:()=>f,routeModule:()=>S,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>j});var s=a(87093),n=a(35244),r=a(1323),i=a(61682),d=a.n(i),o=a(48141),c=a.n(o),x=a(72884),u=e([x]);x=(u.then?(await u)():u)[0];let h=(0,r.l)(x,"default"),m=(0,r.l)(x,"getStaticProps"),p=(0,r.l)(x,"getStaticPaths"),b=(0,r.l)(x,"getServerSideProps"),g=(0,r.l)(x,"config"),f=(0,r.l)(x,"reportWebVitals"),j=(0,r.l)(x,"unstable_getStaticProps"),v=(0,r.l)(x,"unstable_getStaticPaths"),y=(0,r.l)(x,"unstable_getStaticParams"),N=(0,r.l)(x,"unstable_getServerProps"),w=(0,r.l)(x,"unstable_getServerSideProps"),S=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/Admin",pathname:"/Admin",bundlePath:"",filename:""},components:{App:c(),Document:d()},userland:x});l()}catch(e){l(e)}})},33592:(e,t,a)=>{a.d(t,{Z:()=>d});var l=a(16689);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,l.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:i="",children:d,iconNode:o,...c},x)=>(0,l.createElement)("svg",{ref:x,...r,width:t,height:t,stroke:e,strokeWidth:s?24*Number(a)/Number(t):a,className:n("lucide",i),...c},[...o.map(([e,t])=>(0,l.createElement)(e,t)),...Array.isArray(d)?d:[d]])),d=(e,t)=>{let a=(0,l.forwardRef)(({className:a,...r},d)=>(0,l.createElement)(i,{ref:d,iconNode:t,className:n(`lucide-${s(e)}`,a),...r}));return a.displayName=`${e}`,a}},21427:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},47782:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},8268:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},57211:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},41138:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},66152:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},44459:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},74247:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},17911:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},56286:(e,t,a)=>{a.d(t,{Z:()=>l});let l=(0,a(33592).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},48141:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let l=a(45577),s=a(20997),n=l._(a(16689)),r=a(45782);async function i(e){let{Component:t,ctx:a}=e;return{pageProps:await (0,r.loadGetInitialProps)(t,a)}}class d extends n.default.Component{render(){let{Component:e,pageProps:t}=this.props;return(0,s.jsx)(e,{...t})}}d.origGetInitialProps=i,d.getInitialProps=i,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},41460:(e,t,a)=>{a.d(t,{Z:()=>m});var l=a(20997),s=a(41138),n=a(74247),r=a(56286),i=a(8268),d=a(33592);let o=(0,d.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),c=(0,d.Z)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);var x=a(44459),u=a(57211);let h=[{id:"dashboard",label:"Dashboard",icon:s.Z},{id:"orders",label:"Orders & Quotes",icon:n.Z},{id:"clients",label:"Clients",icon:r.Z},{id:"projects",label:"Projects",icon:i.Z},{id:"payments",label:"Payments",icon:o},{id:"services",label:"Services",icon:c},{id:"settings",label:"Settings",icon:x.Z},{id:"gallery",label:"Gallery Manager",icon:u.Z}];function m({activeTab:e,setActiveTab:t}){return(0,l.jsxs)("aside",{className:"w-[230px] bg-[#251e14] text-[#FFD180] border-r border-walnut/30 flex flex-col min-h-screen shadow-2xl",children:[(0,l.jsxs)("div",{className:"p-6 border-b border-walnut/30 flex gap-3 items-center",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-golden-teak flex items-center justify-center",children:l.jsx(s.Z,{className:"w-6 h-6 text-[#704214]"})}),(0,l.jsxs)("div",{children:[l.jsx("h2",{className:"font-bold text-lg text-golden-teak",children:"Venkateshwara CNC"}),l.jsx("span",{className:"text-xs text-gold-leaf/60",children:"Admin Portal"})]})]}),l.jsx("nav",{className:"flex-1 py-8 px-3",children:l.jsx("ul",{className:"space-y-2",children:h.map(a=>(0,l.jsxs)("li",{className:"relative",children:[e===a.id&&l.jsx("span",{className:"absolute left-0 top-0 h-full w-2 bg-gradient-to-b from-golden-teak to-walnut rounded-r-md"}),(0,l.jsxs)("button",{className:`group w-full flex items-center gap-4 pl-6 pr-4 py-3 rounded-lg transition-all font-semibold text-left outline-none
                  ${e===a.id?"bg-gradient-to-r from-golden-teak to-walnut text-[#3a2208] shadow-lg border-l-4 border-golden-teak":"text-gold-leaf hover:bg-gold-leaf/10 hover:text-gold-leaf"}
                  focus-visible:ring-2 focus-visible:ring-golden-teak focus-visible:ring-offset-2 focus-visible:bg-gold-leaf/5
                `,"aria-current":e===a.id?"page":void 0,onClick:()=>t(a.id),tabIndex:0,children:[l.jsx(a.icon,{className:`w-6 h-6 ${e===a.id?"text-[#5c3303]":"text-gold-leaf group-hover:text-[#FFD180]"}`}),l.jsx("span",{className:"text-base",children:a.label})]})]},a.id))})})]})}},95364:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.d(t,{d:()=>c,z:()=>x});var s=a(20997),n=a(16689),r=a(14338),i=a(16926),d=a(27742),o=e([r,i,d]);[r,i,d]=o.then?(await o)():o;let c=(0,i.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-semibold transition-smooth focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-premium hover:shadow-premium-lg hover:-translate-y-1",golden:"gradient-golden text-primary shadow-golden hover:shadow-golden-lg hover:-translate-y-1 hover:scale-105",outline:"border-2 border-secondary bg-transparent text-secondary hover:bg-secondary/10 hover:border-accent hover:text-accent hover:-translate-y-0.5",ghost:"text-secondary hover:text-accent hover:bg-accent/10",link:"text-secondary underline-offset-4 hover:text-accent hover:underline",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80"},size:{default:"h-12 px-8 py-3",sm:"h-10 px-6 py-2 text-sm",lg:"h-14 px-12 py-4 text-base",xl:"h-16 px-14 py-5 text-lg",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),x=n.forwardRef(({className:e,variant:t,size:a,asChild:l=!1,...n},i)=>{let o=l?r.Slot:"button";return s.jsx(o,{className:(0,d.cn)(c({variant:t,size:a,className:e})),ref:i,...n})});x.displayName="Button",l()}catch(e){l(e)}})},37540:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.d(t,{f:()=>x});var s=a(20997);a(16689);var n=a(21427),r=a(47782),i=a(68261),d=a(27742),o=a(95364),c=e([d,o]);function x({className:e,classNames:t,showOutsideDays:a=!0,...l}){return s.jsx(i.DayPicker,{showOutsideDays:a,className:(0,d.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)((0,o.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,d.cn)((0,o.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...e})=>s.jsx(n.Z,{className:"h-4 w-4"}),IconRight:({...e})=>s.jsx(r.Z,{className:"h-4 w-4"})},...l})}[d,o]=c.then?(await c)():c,x.displayName="Calendar",l()}catch(e){l(e)}})},87095:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.d(t,{I:()=>d});var s=a(20997),n=a(16689),r=a(27742),i=e([r]);r=(i.then?(await i)():i)[0];let d=n.forwardRef(({className:e,type:t,...a},l)=>s.jsx("input",{type:t,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:l,...a}));d.displayName="Input",l()}catch(e){l(e)}})},21728:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.d(t,{SP:()=>x,dr:()=>c,mQ:()=>o,nU:()=>u});var s=a(20997),n=a(16689),r=a(6860),i=a(27742),d=e([r,i]);[r,i]=d.then?(await d)():d;let o=r.Root,c=n.forwardRef(({className:e,...t},a)=>s.jsx(r.List,{ref:a,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));c.displayName=r.List.displayName;let x=n.forwardRef(({className:e,...t},a)=>s.jsx(r.Trigger,{ref:a,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));x.displayName=r.Trigger.displayName;let u=n.forwardRef(({className:e,...t},a)=>s.jsx(r.Content,{ref:a,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));u.displayName=r.Content.displayName,l()}catch(e){l(e)}})},27742:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.d(t,{cn:()=>i});var s=a(16593),n=a(68097),r=e([s,n]);function i(...e){return(0,n.twMerge)((0,s.clsx)(e))}[s,n]=r.then?(await r)():r,l()}catch(e){l(e)}})},72884:(e,t,a)=>{a.a(e,async(e,l)=>{try{a.r(t),a.d(t,{default:()=>T,getServerSideProps:()=>O});var s=a(20997),n=a(16689),r=a(41649),i=a(41138),d=a(56286),o=a(66152),c=a(8268),x=a(44459),u=a(74247),h=a(17911),m=a(57211),p=a(95364),b=a(87095),g=a(41460),f=a(37540),j=a(37270),v=a(21728),y=e([p,b,f,j,v]);function N({open:e,onClose:t,client:a,onSaved:l}){let r=["CNC Cutting & Carving","CNC Engraving","Custom Wood Design","Temple Door","Portrait","Decorative Jali & Grills","Wall Art","Furniture Crafting"],[i,d]=(0,n.useState)(""),[o,c]=(0,n.useState)(r[0]),[x,u]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[g,v]=(0,n.useState)("1"),[y,N]=(0,n.useState)("0"),[w,S]=(0,n.useState)("0"),[k,C]=(0,n.useState)(void 0),[P,_]=(0,n.useState)(""),A=()=>parseFloat(h||"0")*parseFloat(g||"1")-parseFloat(y||"0"),D=()=>A()-parseFloat(w||"0"),z=async()=>{if(!i&&!o)return _("Service required");if(!h||isNaN(Number(h)))return _("Valid rate required");let e={customer:a._id,description:x||i||o,rate:parseFloat(h),quantity:parseFloat(g),discount:parseFloat(y),advance:parseFloat(w),total:A(),paid:parseFloat(w),balance:D(),deliveryDate:k,status:"pending"},s=await fetch("/api/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){let e=await s.json();l(e),j.toast.success("Job/Quote created!"),t()}else _("Failed to create job.")};return e?s.jsx("div",{className:"fixed z-50 inset-0 flex items-center justify-center bg-black/40",children:(0,s.jsxs)("div",{className:"bg-walnut/90 text-gold-leaf shadow-2xl rounded-2xl border border-walnut/40",children:[s.jsx("button",{onClick:t,className:"absolute top-2 right-3 text-2xl",children:"\xd7"}),(0,s.jsxs)("h3",{className:"text-xl font-bold mb-3 text-walnut",children:["Add Job / Quote for ",a.name]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm text-walnut mb-1",children:"Service"}),(0,s.jsxs)("select",{className:"w-full h-12 px-4 rounded border",value:o,onChange:e=>c(e.target.value),children:[r.map(e=>s.jsx("option",{value:e,children:e},e)),s.jsx("option",{value:"__custom",children:"Other (enter below)"})]}),"__custom"===o&&s.jsx(b.I,{className:"mt-2",placeholder:"Custom service",value:i,onChange:e=>d(e.target.value)})]}),s.jsx("div",{children:s.jsx(b.I,{placeholder:"Description (optional)",value:x,onChange:e=>u(e.target.value)})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(b.I,{className:"w-1/2",type:"number",placeholder:"Rate",value:h,onChange:e=>m(e.target.value)}),s.jsx(b.I,{className:"w-1/2",type:"number",placeholder:"Quantity",value:g,onChange:e=>v(e.target.value)})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(b.I,{className:"w-1/2",type:"number",placeholder:"Advance",value:w,onChange:e=>S(e.target.value)}),s.jsx(b.I,{className:"w-1/2",type:"number",placeholder:"Discount",value:y,onChange:e=>N(e.target.value)})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm mb-1 text-walnut",children:"Expected Delivery Date (optional):"}),s.jsx(f.f,{selected:k,onSelect:C})]}),(0,s.jsxs)("div",{className:"text-sandalwood text-sm",children:["Total: ₹",A()," | Balance: ₹",D()]}),P&&s.jsx("div",{className:"text-red-600 text-sm",children:P}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 justify-end",children:[s.jsx(p.z,{variant:"outline",onClick:t,type:"button",children:"Cancel"}),s.jsx(p.z,{variant:"golden",type:"button",onClick:z,children:"Add Job / Quote"})]})]})]})}):null}function w({open:e,onClose:t,onSave:a,initial:l}){let[r,i]=(0,n.useState)(l?.name||""),[d,o]=(0,n.useState)(l?.phone||""),[c,x]=(0,n.useState)(l?.email||""),[u,h]=(0,n.useState)(l?.deliveryDate?new Date(l.deliveryDate):void 0),[m,g]=(0,n.useState)("");return e?s.jsx("div",{className:"fixed z-50 inset-0 flex items-center justify-center bg-black/40",children:(0,s.jsxs)("div",{className:"bg-walnut/90 text-gold-leaf shadow-2xl rounded-2xl border border-walnut/40",children:[s.jsx("button",{onClick:t,className:"absolute top-2 right-3 text-2xl",children:"\xd7"}),s.jsx("h3",{className:"text-xl font-bold mb-3 text-walnut",children:l?"Edit Client":"Add Client"}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("div",{children:s.jsx(b.I,{placeholder:"Full Name",value:r,onChange:e=>i(e.target.value),required:!0})}),s.jsx("div",{children:s.jsx(b.I,{placeholder:"Phone",value:d,onChange:e=>o(e.target.value)})}),s.jsx("div",{children:s.jsx(b.I,{placeholder:"Email",value:c,onChange:e=>x(e.target.value)})}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm mb-1 text-walnut",children:"Expected Delivery Date (optional):"}),s.jsx(f.f,{selected:u,onSelect:h})]}),m&&s.jsx("div",{className:"text-red-600 text-sm",children:m}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 justify-end",children:[s.jsx(p.z,{variant:"outline",onClick:t,type:"button",children:"Cancel"}),s.jsx(p.z,{variant:"golden",type:"button",onClick:()=>{if(!r)return g("Name required");a({name:r,phone:d,email:c,deliveryDate:u})},children:l?"Save Changes":"Add Client"})]})]})]})}):null}function S(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(!1),[r,i]=(0,n.useState)(void 0),[d,o]=(0,n.useState)(""),[c,x]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),m=d?e.filter(e=>e.name?.toLowerCase().includes(d.toLowerCase())||e.phone?.includes(d)):e,g=e=>{i(e),l(!0)},f=async e=>{if(l(!1),r&&r._id)(await fetch(`/api/customers/${r._id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&t(t=>t.map(t=>t._id===r._id?{...t,...e}:t));else{let a=await fetch("/api/customers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();t(t=>[e,...t])}}};return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-walnut",children:"Manage Clients"}),s.jsx(p.z,{variant:"golden",onClick:()=>g(),children:"+ Add Client"})]}),s.jsx("div",{className:"mb-3 max-w-xs",children:s.jsx(b.I,{placeholder:"Search by name or phone",value:d,onChange:e=>o(e.target.value)})}),s.jsx("div",{className:"overflow-x-auto rounded-lg border bg-card",children:(0,s.jsxs)("table",{className:"min-w-full text-left divide-y divide-walnut/30 even:bg-walnut/10 odd:bg-walnut/5",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-walnut/80 text-golden-teak",children:[s.jsx("th",{className:"py-2 px-3",children:"Name"}),s.jsx("th",{className:"py-2 px-3",children:"Phone"}),s.jsx("th",{className:"py-2 px-3",children:"Email"}),s.jsx("th",{className:"py-2 px-3",children:"Created"}),s.jsx("th",{className:"py-2 px-3",children:"Delivery"}),s.jsx("th",{className:"py-2 px-3 text-center",children:"Action"})]})}),(0,s.jsxs)("tbody",{children:[m.map(e=>(0,s.jsxs)("tr",{className:"border-t last:border-b hover:bg-golden-teak/10",children:[s.jsx("td",{className:"px-3 py-2",children:e.name}),s.jsx("td",{className:"px-3 py-2",children:e.phone}),s.jsx("td",{className:"px-3 py-2",children:e.email}),s.jsx("td",{className:"px-3 py-2",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"}),s.jsx("td",{className:"px-3 py-2",children:e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():s.jsx("span",{className:"text-muted-foreground",children:"-"})}),(0,s.jsxs)("td",{className:"px-3 py-2 text-center",children:[s.jsx(p.z,{size:"sm",variant:"outline",onClick:()=>g(e),children:"Edit"}),s.jsx(p.z,{size:"sm",variant:"golden",className:"ml-2",onClick:()=>{h(e),x(!0)},children:"New Job / Quote"})]})]},e._id)),0===m.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"text-muted-foreground p-6 text-center",children:"No clients found."})})]})]})}),s.jsx(w,{open:a,onClose:()=>l(!1),onSave:f,initial:r}),s.jsx(N,{open:c,onClose:()=>x(!1),client:u,onSaved:()=>{}})]})}function k({open:e,onClose:t,job:a,onSaved:l}){let[r,i]=(0,n.useState)(""),[d,o]=(0,n.useState)(new Date),[c,x]=(0,n.useState)(""),u=async()=>{if(!r||isNaN(Number(r)))return x("Valid payment required");(await fetch("/api/payments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer:a.customer._id,job:a._id,amount:parseFloat(r),date:d})})).ok?(l(),t(),j.toast.success("Payment recorded.")):x("Failed to add payment.")};return e?s.jsx("div",{className:"fixed z-50 inset-0 flex items-center justify-center bg-black/50",children:(0,s.jsxs)("div",{className:"bg-walnut/90 text-gold-leaf shadow-2xl rounded-2xl border border-walnut/40",children:[s.jsx("button",{onClick:t,className:"absolute top-2 right-3 text-2xl",children:"\xd7"}),s.jsx("h3",{className:"text-xl font-bold mb-3 text-walnut",children:"Record Payment"}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx(b.I,{placeholder:"Amount",type:"number",value:r,onChange:e=>i(e.target.value)}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm mb-1 text-walnut",children:"Date:"}),s.jsx(f.f,{selected:d,onSelect:o})]}),c&&s.jsx("div",{className:"text-red-600 text-sm",children:c}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 justify-end",children:[s.jsx(p.z,{variant:"outline",onClick:t,children:"Cancel"}),s.jsx(p.z,{variant:"golden",onClick:u,children:"Add Payment"})]})]})]})}):null}function C(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),[r,i]=(0,n.useState)(""),[d,o]=(0,n.useState)(!1),[c,x]=(0,n.useState)(null),u=()=>fetch("/api/jobs").then(async e=>{let t=await e.text();if(!t)return[];try{return JSON.parse(t)}catch{return[]}}).then(t),h=async t=>{await u();let a=e.find(e=>e._id===t._id);a&&a.paid>=a.total&&"completed"!==a.status&&(await fetch(`/api/jobs/${a._id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"completed"})}),await u(),j.toast.success("Job marked as completed!"))},m=e.filter(e=>(!a||(e.customer?.name||"").toLowerCase().includes(a.toLowerCase()))&&(!r||e.status===r)),g=async e=>{try{let t=await fetch(`/api/invoices?job=${e._id}`),a=null;if(t.ok){let e=await t.json();Array.isArray(e)&&e.length>0&&(a=e[0])}if(!a){if((t=await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer:e.customer._id,jobs:[e._id],subtotal:e.total,discount:e.discount||0,total:e.total-(e.discount||0),paid:e.paid,balance:e.balance,number:`INV-${new Date().getFullYear()}-${Math.floor(1e4*Math.random())}`})})).ok)a=await t.json();else throw Error("Failed to create invoice.")}a&&a._id?(window.open(`/api/invoices/${a._id}/pdf`,"_blank"),j.toast.success("Invoice ready!")):j.toast.error("Something went wrong generating invoice.")}catch{j.toast.error("Error generating invoice.")}};return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap justify-between gap-2 mb-6",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"Orders & Quotes"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(b.I,{placeholder:"Search client",value:a,onChange:e=>l(e.target.value)}),(0,s.jsxs)("select",{value:r,onChange:e=>i(e.target.value),className:"rounded border h-10 px-3 ml-2",children:[s.jsx("option",{value:"",children:"Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"})]})]})]}),s.jsx("div",{className:"overflow-x-auto rounded-2xl shadow-xl border-none bg-[#fff8e1] w-full mt-2 mb-6",children:(0,s.jsxs)("table",{className:"min-w-full text-left ",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-[#fcdf9b] border-b-2 border-golden-teak text-[#442609] text-lg font-bold",children:[s.jsx("th",{className:"py-4 px-4",children:"Service"}),s.jsx("th",{className:"py-4 px-4",children:"Client"}),s.jsx("th",{className:"py-4 px-4",children:"Dates"}),s.jsx("th",{className:"py-4 px-4",children:"Total"}),s.jsx("th",{className:"py-4 px-4",children:"Paid"}),s.jsx("th",{className:"py-4 px-4",children:"Balance"}),s.jsx("th",{className:"py-4 px-4",children:"Status"}),s.jsx("th",{className:"py-4 px-4 text-center",children:"Actions"})]})}),(0,s.jsxs)("tbody",{children:[m.map((e,t)=>(0,s.jsxs)("tr",{className:t%2==0?"bg-[#fff8e1] text-[#1a1204]":"bg-[#f8e3b0] text-[#1a1204] border-t border-gold-leaf/30 hover:bg-gold-leaf/10 transition",children:[s.jsx("td",{className:"px-4 py-3 font-medium",children:e.description}),s.jsx("td",{className:"px-4 py-3",children:e.customer?.name}),(0,s.jsxs)("td",{className:"px-4 py-3",children:[e.createdAt?new Date(e.createdAt).toLocaleDateString():"-",s.jsx("br",{}),e.deliveryDate?"→ "+new Date(e.deliveryDate).toLocaleDateString():""]}),(0,s.jsxs)("td",{className:"px-4 py-3 font-bold",children:["₹",e.total]}),(0,s.jsxs)("td",{className:"px-4 py-3",children:["₹",e.paid]}),(0,s.jsxs)("td",{className:"px-4 py-3",children:["₹",e.balance]}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold ${"completed"===e.status?"bg-green-200 text-green-900":"pending"===e.status?"bg-yellow-100 text-yellow-900":"bg-blue-100 text-blue-900"}`,children:e.status})}),(0,s.jsxs)("td",{className:"px-4 py-3 text-center",children:[s.jsx(p.z,{size:"lg",variant:"golden",className:"bg-gradient-to-r from-gold-leaf to-golden-teak text-[#312106] font-bold shadow-lg px-6 py-2 rounded-xl border-2 border-golden-teak hover:from-golden-teak hover:to-gold-leaf transition",onClick:()=>{x(e),o(!0)},children:"Add Payment"}),"completed"===e.status?s.jsx(p.z,{size:"lg",variant:"golden",className:"ml-3 px-4 py-2 font-bold shadow border-golden-teak",onClick:()=>g(e),children:"Invoice"}):null]})]},e._id)),0===m.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"text-muted-foreground p-6 text-center",children:"No jobs found."})})]})]})}),s.jsx(k,{open:d,onClose:()=>o(!1),job:c,onSaved:()=>h(c)})]})}function P({open:e,onClose:t,job:a,generateOrOpenInvoice:l}){return e&&a?s.jsx("div",{className:"fixed z-50 inset-0 flex items-center justify-center bg-black/40",children:(0,s.jsxs)("div",{className:"relative bg-[#fff8e1] text-[#312106] shadow-2xl rounded-2xl border-2 border-golden-teak px-10 py-8 min-w-[360px] max-w-full w-[90vw] md:w-[520px] animate-fadeIn",children:[s.jsx("button",{"aria-label":"Close",onClick:t,className:"absolute top-5 right-5 text-3xl text-golden-teak hover:text-red-500 transition-colors bg-transparent p-1.5 rounded-full focus:outline-none focus:ring-2 focus:ring-gold-leaf/40",children:"\xd7"}),s.jsx("h3",{className:"text-2xl font-bold mb-4 text-golden-teak border-b-2 border-golden-teak pb-2",children:"Job Details"}),(0,s.jsxs)("div",{className:"mb-1",children:[s.jsx("span",{className:"font-bold text-walnut",children:"Client:"})," ",a.customer?.name," (",a.customer?.phone||"No phone",")"]}),(0,s.jsxs)("div",{className:"mb-1 text-base",children:["Created: ",a.createdAt?new Date(a.createdAt).toLocaleDateString():"-"," \xa0|\xa0 Delivery: ",a.deliveryDate?new Date(a.deliveryDate).toLocaleDateString():"-"]}),(0,s.jsxs)("div",{className:"mb-1",children:[s.jsx("span",{className:"font-bold",children:"Service:"})," ",a.description]}),(0,s.jsxs)("div",{className:"mb-1",children:["Rate: ",(0,s.jsxs)("b",{children:["₹",a.rate]}),", Qty: ",s.jsx("b",{children:a.quantity}),", Discount: ",(0,s.jsxs)("b",{children:["₹",a.discount]}),", Advance: ",(0,s.jsxs)("b",{children:["₹",a.advance]})]}),(0,s.jsxs)("div",{className:"mb-2",children:["Paid: ",(0,s.jsxs)("b",{children:["₹",a.paid]}),", Balance: ",(0,s.jsxs)("b",{children:["₹",a.balance]}),", \xa0 ",s.jsx("span",{className:"font-bold",children:"Status:"})," ",s.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold ml-1 ${"completed"===a.status?"bg-green-200 text-green-900":"pending"===a.status?"bg-yellow-100 text-yellow-900":"bg-blue-100 text-blue-900"}`,children:a.status})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:["completed"===a.status&&s.jsx(p.z,{variant:"golden",className:"flex-1",onClick:()=>l(a),children:"Generate/View Invoice"}),s.jsx(p.z,{variant:"outline",onClick:t,className:"flex-1",children:"Close"})]})]})}):null}function _(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),[r,i]=(0,n.useState)(null),d=e.filter(e=>!a||(e.customer?.name||"").toLowerCase().includes(a.toLowerCase())),o=async e=>{try{let t=await fetch(`/api/invoices?job=${e._id}`),a=null;if(t.ok){let e=await t.json();Array.isArray(e)&&e.length>0&&(a=e[0])}if(!a){if((t=await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer:e.customer._id,jobs:[e._id],subtotal:e.total,discount:e.discount||0,total:e.total-(e.discount||0),paid:e.paid,balance:e.balance,number:`INV-${new Date().getFullYear()}-${Math.floor(1e4*Math.random())}`})})).ok)a=await t.json();else throw Error("Failed to create invoice.")}a&&a._id?(window.open(`/api/invoices/${a._id}/pdf`,"_blank"),j.toast.success("Invoice ready!")):j.toast.error("Something went wrong generating invoice.")}catch{j.toast.error("Error generating invoice.")}};return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap justify-between gap-2 mb-6",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"All Projects / Jobs"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(b.I,{placeholder:"Search client/job",value:a,onChange:e=>l(e.target.value)}),s.jsx(p.z,{variant:"outline",onClick:()=>{window.open("/api/export/jobs","_blank")},children:"Export CSV"})]})]}),s.jsx("div",{className:"overflow-x-auto rounded-2xl border-none bg-[#fff8e1] w-full mt-2 mb-6",children:(0,s.jsxs)("table",{className:"min-w-full text-left ",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-[#fcdf9b] border-b-2 border-golden-teak text-[#442609] text-lg font-bold",children:[s.jsx("th",{className:"py-4 px-4",children:"Job"}),s.jsx("th",{className:"py-4 px-4",children:"Client"}),s.jsx("th",{className:"py-4 px-4",children:"Created"}),s.jsx("th",{className:"py-4 px-4",children:"Total"}),s.jsx("th",{className:"py-4 px-4",children:"Paid"}),s.jsx("th",{className:"py-4 px-4",children:"Balance"}),s.jsx("th",{className:"py-4 px-4",children:"Status"}),s.jsx("th",{className:"py-4 px-4 text-center",children:"Action"})]})}),(0,s.jsxs)("tbody",{children:[d.map(e=>(0,s.jsxs)("tr",{className:"even:bg-[#fff8e1] odd:bg-[#f8e3b0] text-[#1a1204] border-t border-gold-leaf/30 hover:bg-gold-leaf/10 transition",children:[s.jsx("td",{className:"px-4 py-3 font-medium",children:e.description}),s.jsx("td",{className:"px-4 py-3",children:e.customer?.name}),s.jsx("td",{className:"px-4 py-3",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"}),(0,s.jsxs)("td",{className:"px-4 py-3",children:["₹",e.total]}),(0,s.jsxs)("td",{className:"px-4 py-3",children:["₹",e.paid]}),(0,s.jsxs)("td",{className:"px-4 py-3",children:["₹",e.balance]}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold ${"completed"===e.status?"bg-green-200 text-green-900":"pending"===e.status?"bg-yellow-100 text-yellow-900":"bg-blue-100 text-blue-900"}`,children:e.status})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx(p.z,{size:"sm",variant:"outline",onClick:()=>i(e),children:"View"})})]},e._id)),0===d.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"text-muted-foreground p-6 text-center",children:"No jobs found."})})]})]})}),s.jsx(P,{open:!!r,onClose:()=>i(null),job:r,generateOrOpenInvoice:o})]})}function A(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),[r,i]=(0,n.useState)(-1),[d,o]=(0,n.useState)(""),c=async()=>{a&&(await fetch("/api/services",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})}),t(e=>[a,...e]),l(""))},x=async a=>{await fetch("/api/services",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({old:e[a],name:d})}),t(e=>e.map((e,t)=>t===a?d:e)),i(-1),o("")},u=async a=>{await fetch("/api/services",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e[a]})}),t(e=>e.filter((e,t)=>t!==a))};return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap justify-between gap-2 mb-6",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"Service Master List"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(b.I,{placeholder:"Add new service",value:a,onChange:e=>l(e.target.value)}),s.jsx(p.z,{variant:"golden",onClick:c,children:"Add"})]})]}),s.jsx("div",{className:"overflow-x-auto rounded-2xl border-none bg-[#fff8e1] w-full mt-2 mb-6 max-w-lg",children:(0,s.jsxs)("table",{className:"min-w-full text-left ",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-[#fcdf9b] border-b-2 border-golden-teak text-[#442609] text-lg font-bold",children:[s.jsx("th",{className:"py-4 px-4",children:"Service"}),s.jsx("th",{className:"py-4 px-4"})]})}),(0,s.jsxs)("tbody",{children:[e.map((e,t)=>(0,s.jsxs)("tr",{className:"even:bg-[#fff8e1] odd:bg-[#f8e3b0] text-[#1a1204] border-t border-gold-leaf/30 hover:bg-gold-leaf/10 transition",children:[s.jsx("td",{className:"px-4 py-3",children:r===t?s.jsx(b.I,{value:d,onChange:e=>o(e.target.value)}):e}),(0,s.jsxs)("td",{className:"px-4 py-3 text-right",children:[r===t?s.jsx(p.z,{size:"sm",variant:"golden",onClick:()=>x(t),children:"Save"}):s.jsx(p.z,{size:"sm",variant:"outline",onClick:()=>{i(t),o(e)},children:"Edit"}),s.jsx(p.z,{size:"sm",variant:"outline",className:"ml-2",onClick:()=>u(t),children:"Delete"})]})]},e+t)),0===e.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:2,className:"text-muted-foreground p-6 text-center",children:"No services"})})]})]})})]})}function D(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(""),r=e.filter(e=>!a||e.customer?.name.toLowerCase().includes(a.toLowerCase()));return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap justify-between gap-2 mb-6",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"All Payments"}),s.jsx("div",{className:"flex gap-2",children:s.jsx(b.I,{placeholder:"Search client/job",value:a,onChange:e=>l(e.target.value)})})]}),s.jsx("div",{className:"overflow-x-auto rounded-2xl border-none bg-[#fff8e1] w-full mt-2 mb-6",children:(0,s.jsxs)("table",{className:"min-w-full text-left ",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-[#fcdf9b] border-b-2 border-golden-teak text-[#442609] text-lg font-bold",children:[s.jsx("th",{className:"py-4 px-4",children:"Client"}),s.jsx("th",{className:"py-4 px-4",children:"Job/service"}),s.jsx("th",{className:"py-4 px-4",children:"Amount"}),s.jsx("th",{className:"py-4 px-4",children:"Date"})]})}),(0,s.jsxs)("tbody",{children:[r.map(e=>(0,s.jsxs)("tr",{className:"even:bg-[#fff8e1] odd:bg-[#f8e3b0] text-[#1a1204] border-t border-gold-leaf/30 hover:bg-gold-leaf/10 transition",children:[s.jsx("td",{className:"px-4 py-3 font-medium",children:e.customer?.name}),s.jsx("td",{className:"px-4 py-3",children:e.job&&e.job.description}),(0,s.jsxs)("td",{className:"px-4 py-3",children:["₹",e.amount]}),s.jsx("td",{className:"px-4 py-3",children:e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"})]},e._id)),0===r.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"text-muted-foreground p-6 text-center",children:"No payments"})})]})]})})]})}function z(){let[e,t]=(0,n.useState)(""),[a,l]=(0,n.useState)("");return(0,s.jsxs)("div",{className:"p-8",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"Admin Settings"}),(0,s.jsxs)("form",{className:"space-y-6 mt-6 max-w-xl",onSubmit:e=>{e.preventDefault(),(0,j.toast)("Updating ENV settings via web is restricted. Please update .env.local manually for changes to take effect.")},children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block mb-1 text-walnut",children:"Admin Email"}),s.jsx(b.I,{value:e,onChange:e=>t(e.target.value),disabled:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block mb-1 text-walnut",children:"Password"}),s.jsx(b.I,{value:a,onChange:e=>l(e.target.value),type:"password",placeholder:"(set in .env)",disabled:!0})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block mb-1 text-walnut",children:"Brand Logo (future)"}),s.jsx("input",{type:"file",disabled:!0,className:"border p-2 rounded w-full"})]}),s.jsx(p.z,{type:"submit",variant:"golden",className:"w-full",children:"Update"})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-3",children:["To update admin credentials or branding, edit ",s.jsx("b",{children:".env.local"})," and restart your app for security. Signed-in only, always protected."]})]})}function I(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(!1),[r,i]=(0,n.useState)(null),d=(0,n.useRef)(null),[o,c]=(0,n.useState)(""),[x,u]=(0,n.useState)(""),[h,m]=(0,n.useState)(null),[g,f]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),N=async()=>{if(!r)return;l(!0);let e=new FormData;e.append("file",r),e.append("title",o),e.append("category",x);try{let a=await fetch("/api/media/upload",{method:"POST",body:e});if(a.ok){let e=await a.json();t(t=>[...t,e]),j.toast.success("Image uploaded!")}else{let e=await a.json();j.toast.error(e.message||"Failed to upload image.")}}catch(e){j.toast.error("An unexpected error occurred.")}finally{i(null),c(""),u(""),l(!1)}};return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"flex flex-wrap justify-between gap-2 mb-6",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"Gallery Manager"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx(b.I,{placeholder:"Title",value:o,onChange:e=>c(e.target.value)}),s.jsx(b.I,{placeholder:"Category",value:x,onChange:e=>u(e.target.value)}),s.jsx(p.z,{variant:"outline",onClick:()=>d.current?.click(),children:"Choose File"}),s.jsx("input",{onChange:e=>i(e.target.files?.[0]??null),ref:d,type:"file",className:"hidden"}),r&&s.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:r.name}),s.jsx(p.z,{className:"text-black",variant:"golden",onClick:N,disabled:a||!r,children:"Upload"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 w-full bg-[#fff8e1] rounded-2xl p-6",children:[0===e.length&&s.jsx("div",{className:"col-span-full text-muted-foreground p-6 text-center",children:"No images"}),e.map(e=>(0,s.jsxs)("div",{className:"rounded-lg overflow-hidden border border-gold-leaf/30 bg-[#f8e3b0] flex flex-col",children:[s.jsx("img",{src:e.url,alt:e.title,className:"object-cover h-40 w-full"}),(0,s.jsxs)("div",{className:"p-2",children:[s.jsx("div",{className:"font-bold text-walnut text-lg mb-1",children:e.title}),s.jsx("div",{className:"text-sandalwood text-sm",children:e.category})]})]},e._id))]})]})}function Z(){let[e,t]=(0,n.useState)({});return(0,s.jsxs)("div",{className:"p-8",children:[s.jsx("h2",{className:"text-3xl font-extrabold text-golden-teak mb-2 border-b-4 border-golden-teak pb-2 w-full pl-1",children:"Admin Dashboard"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-8 mt-6",children:[(0,s.jsxs)("div",{className:"bg-walnut/60 rounded-xl p-6 shadow flex flex-col items-center",children:[s.jsx("div",{className:"text-golden-teak text-3xl font-bold",children:e.totalJobs??"-"}),s.jsx("div",{className:"text-sandalwood mt-2",children:"Jobs/Orders"})]}),(0,s.jsxs)("div",{className:"bg-walnut/60 rounded-xl p-6 shadow flex flex-col items-center",children:[s.jsx("div",{className:"text-golden-teak text-3xl font-bold",children:e.totalAmount?`₹${e.totalAmount}`:"-"}),s.jsx("div",{className:"text-sandalwood mt-2",children:"Total Revenue"})]}),(0,s.jsxs)("div",{className:"bg-walnut/60 rounded-xl p-6 shadow flex flex-col items-center",children:[s.jsx("div",{className:"text-golden-teak text-3xl font-bold",children:e.totalAdvance?`₹${e.totalAdvance}`:"-"}),s.jsx("div",{className:"text-sandalwood mt-2",children:"Advances"})]}),(0,s.jsxs)("div",{className:"bg-walnut/60 rounded-xl p-6 shadow flex flex-col items-center",children:[s.jsx("div",{className:"text-golden-teak text-3xl font-bold",children:e.totalBalance?`₹${e.totalBalance}`:"-"}),s.jsx("div",{className:"text-sandalwood mt-2",children:"Outstanding"})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 flex-wrap mb-4",children:[s.jsx(p.z,{variant:"golden",onClick:()=>document.querySelector('[aria-label="Clients"]')?.scrollIntoView(),children:"Manage Clients"}),s.jsx(p.z,{variant:"golden",onClick:()=>document.querySelector('[aria-label="Orders & Quotes"]')?.scrollIntoView(),children:"Orders & Quotes"}),s.jsx(p.z,{variant:"golden",onClick:()=>document.querySelector('[aria-label="Projects"]')?.scrollIntoView(),children:"Projects"}),s.jsx(p.z,{variant:"golden",onClick:()=>document.querySelector('[aria-label="Gallery Manager"]')?.scrollIntoView(),children:"Gallery"})]}),s.jsx("div",{className:"text-sandalwood",children:"Jump to any section above, or use the sidebar for advanced management and search."})]})}[p,b,f,j,v]=y.then?(await y)():y;let T=function(){let{data:e}=(0,r.useSession)(),[t,a]=(0,n.useState)("dashboard"),[l,b]=(0,n.useState)(""),[f,j]=(0,n.useState)(""),[y,N]=(0,n.useState)(null),w=async e=>{e.preventDefault();let t=await (0,r.signIn)("credentials",{email:l,password:f,redirect:!1});!t||t.error?N("Invalid email or password"):N(null)};return e?(0,s.jsxs)("div",{className:"flex",children:[s.jsx(g.Z,{activeTab:t,setActiveTab:a}),(0,s.jsxs)("main",{className:"flex-1 p-8",children:[s.jsx("h1",{className:"text-4xl font-bold text-walnut mb-6",children:"Admin Panel"}),s.jsx("div",{className:"mt-6",children:(0,s.jsxs)(v.mQ,{value:t,onValueChange:a,className:"w-full",children:[(0,s.jsxs)(v.dr,{className:"grid w-full grid-cols-4",children:[(0,s.jsxs)(v.SP,{value:"dashboard","aria-label":"Dashboard",children:[s.jsx(i.Z,{className:"mr-2 h-4 w-4"}),"Dashboard"]}),(0,s.jsxs)(v.SP,{value:"clients","aria-label":"Clients",children:[s.jsx(d.Z,{className:"mr-2 h-4 w-4"}),"Clients"]}),(0,s.jsxs)(v.SP,{value:"orders","aria-label":"Orders & Quotes",children:[s.jsx(o.Z,{className:"mr-2 h-4 w-4"}),"Orders & Quotes"]}),(0,s.jsxs)(v.SP,{value:"projects","aria-label":"Projects",children:[s.jsx(c.Z,{className:"mr-2 h-4 w-4"}),"Projects"]}),(0,s.jsxs)(v.SP,{value:"services","aria-label":"Service Master List",children:[s.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Services"]}),(0,s.jsxs)(v.SP,{value:"payments","aria-label":"All Payments",children:[s.jsx(u.Z,{className:"mr-2 h-4 w-4"}),"Payments"]}),(0,s.jsxs)(v.SP,{value:"settings","aria-label":"Admin Settings",children:[s.jsx(h.Z,{className:"mr-2 h-4 w-4"}),"Settings"]}),(0,s.jsxs)(v.SP,{value:"gallery","aria-label":"Gallery Manager",children:[s.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"Gallery"]})]}),s.jsx(v.nU,{value:"dashboard",children:s.jsx(Z,{})}),s.jsx(v.nU,{value:"clients",children:s.jsx(S,{})}),s.jsx(v.nU,{value:"orders",children:s.jsx(C,{})}),s.jsx(v.nU,{value:"projects",children:s.jsx(_,{})}),s.jsx(v.nU,{value:"services",children:s.jsx(A,{})}),s.jsx(v.nU,{value:"payments",children:s.jsx(D,{})}),s.jsx(v.nU,{value:"settings",children:s.jsx(z,{})}),s.jsx(v.nU,{value:"gallery",children:s.jsx(I,{})})]})})]})]}):s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-walnut",children:(0,s.jsxs)("div",{className:"bg-walnut/90 text-gold-leaf shadow-2xl rounded-2xl border border-walnut/40 p-8",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4 text-walnut",children:"Admin Login"}),s.jsx("p",{className:"text-walnut mb-4",children:"Sign in with your admin email and password."}),(0,s.jsxs)("form",{className:"space-y-4",onSubmit:w,children:[s.jsx("input",{type:"email",value:l,onChange:e=>b(e.target.value),placeholder:"Email",className:"border rounded p-2 w-full text-walnut",required:!0}),s.jsx("input",{type:"password",value:f,onChange:e=>j(e.target.value),placeholder:"Password",className:"border rounded p-2 w-full text-walnut",required:!0}),y&&s.jsx("div",{className:"text-red-600 text-sm",children:y}),s.jsx(p.z,{type:"submit",className:"w-full",children:"Sign in"})]})]})})};async function O(){return{props:{}}}l()}catch(e){l(e)}})},35244:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},41649:e=>{e.exports=require("next-auth/react")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},16689:e=>{e.exports=require("react")},68261:e=>{e.exports=require("react-day-picker")},20997:e=>{e.exports=require("react/jsx-runtime")},55315:e=>{e.exports=require("path")},14338:e=>{e.exports=import("@radix-ui/react-slot")},6860:e=>{e.exports=import("@radix-ui/react-tabs")},16926:e=>{e.exports=import("class-variance-authority")},16593:e=>{e.exports=import("clsx")},37270:e=>{e.exports=import("sonner")},68097:e=>{e.exports=import("tailwind-merge")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),l=t.X(0,[1682],()=>a(53425));module.exports=l})();